---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
<br>

```{r load data}
setwd("C:/Users/Cubbi_000/Desktop/Coursera/reproducible_research/project1/RepData_PeerAssessment1")
unzip('activity.zip')
activity <- read.csv('activity.csv')
```
  
<br>
These are the summary statistics of our resulting activity dataframe  
<br>
  
```{r show summary}
summary(activity)
```


## What is mean total number of steps taken per day?

<br>
We're going to use the dplyr package to group the results by each day. 
<br>

```{r, results='hide'}
library(dplyr)
```

<br>
The table total_steps will have each day and the total number of steps taken during the course of that day
<br>

```{r}
by_day <- group_by(activity, date)
total_steps <- summarize(by_day, steps = sum(steps))
hist(total_steps$steps, xlab = 'Steps Taken Per Day', main = 'Histogram of Steps Per Day')

```  

<br>
The summary will tell us the mean and median of steps per day.
<br>

```{r}
summary(total_steps)
```

<br>
On average, this person took 10,766 steps per day for each day that was recorded.   
The median is very similar, at 10,765 steps per day.
<br>

## What is the average daily activity pattern?

```{r}
by_time <- group_by(activity, interval)
steps_time <- summarize(by_time, steps_avg = mean(steps, na.rm = TRUE))
with(steps_time, plot(interval, steps_avg, type = 'l', main = 'Average Steps Taken for Each Interval'))
```

```{r}
steps_time[steps_time$steps_avg == max(steps_time$steps_avg),]
```

## Imputing missing values

```{r}
summary(activity[apply(is.na(activity), 1, any), ])
```

```{r}
activity2 <- left_join(activity, steps_time)
activity2[is.na(activity2$steps),1] <- activity2[is.na(activity2$steps),4]
act.no.na <- activity2[,1:3]
```

```{r}
by_day2 <- group_by(act.no.na, date)
total_steps2 <- summarize(by_day2, steps = sum(steps))
hist(total_steps2$steps, xlab = 'Steps Taken Per Day', main = 'Histogram of Steps Per Day, NAs Removed')
```  

```{r}
summary(total_steps2)
```

## Are there differences in activity patterns between weekdays and weekends?

```{r}
activity$date <- as.Date(activity$date)
activity$day <- weekdays(activity$date)
activity$weekday <- activity$day %in% c('Saturday', 'Sunday')
```










